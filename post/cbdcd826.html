<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>端口扫描 | Ulysses'Blog</title><meta name="keywords" content="扫描与枚举"><meta name="author" content="Ulysses"><meta name="copyright" content="Ulysses"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="网络端口何为端口在网络技术中，端口(Port)大致有两种意思：一是物理意义上的端口，比如，ADSL Modem、集线器、交换机、路由器用于连接其他网络设备的接口，如RJ-45端口、SC端口等等；二是逻辑意义上的端口，一般是指TCP&#x2F;IP协议中的端口，端口号的范围从0到65535，比如用于浏览网页服务的80端口，用于FTP服务的21端口等等。 端口分类按端口号可分为3大类：  公认端口（Well K">
<meta property="og:type" content="article">
<meta property="og:title" content="端口扫描">
<meta property="og:url" content="https://plumeria.ltd/post/cbdcd826.html">
<meta property="og:site_name" content="Ulysses&#39;Blog">
<meta property="og:description" content="网络端口何为端口在网络技术中，端口(Port)大致有两种意思：一是物理意义上的端口，比如，ADSL Modem、集线器、交换机、路由器用于连接其他网络设备的接口，如RJ-45端口、SC端口等等；二是逻辑意义上的端口，一般是指TCP&#x2F;IP协议中的端口，端口号的范围从0到65535，比如用于浏览网页服务的80端口，用于FTP服务的21端口等等。 端口分类按端口号可分为3大类：  公认端口（Well K">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://plumeria.ltd/img/tools/nmap.jpg">
<meta property="article:published_time" content="2021-10-05T11:00:24.000Z">
<meta property="article:modified_time" content="2021-10-06T07:45:58.556Z">
<meta property="article:author" content="Ulysses">
<meta property="article:tag" content="扫描与枚举">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://plumeria.ltd/img/tools/nmap.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://plumeria.ltd/post/cbdcd826"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.10.5/dist/instantsearch.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.10.5/dist/instantsearch.min.js" defer></script><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: {"appId":"W86Z4BMIXY","apiKey":"ab43a60eaebc9c628f7b1eb55825160f","indexName":"my blog","hits":{"per_page":6},"languages":{"input_placeholder":"搜索文章","hits_empty":"找不到您查询的内容：${query}","hits_stats":"找到 ${hits} 条结果，用时 ${time} 毫秒"}},
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '端口扫描',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2021-10-06 15:45:58'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if (GLOBAL_CONFIG_SITE.isHome && /iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/css/mycss.css"><style type="text/css">.aplayer.aplayer-fixed.aplayer-narrow .aplayer-body{left:-66px!important}.aplayer.aplayer-fixed.aplayer-narrow .aplayer-body:hover{left:0!important}</style><div class="aplayer" data-id="6971899287" data-server="netease" data-type="playlist" data-fixed="true" data-listFolded="false" data-order="random" data-preload="none"></div><link rel="stylesheet" href="https://cdn.bootcss.com/aplayer/1.10.1/APlayer.min.css"><script src="https://cdn.bootcss.com/aplayer/1.10.1/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/gh/metowolf/MetingJS@1.2/dist/Meting.min.js"></script><meta name="generator" content="Hexo 5.4.0"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/gif/loading4.gif" data-original="https://avatars.githubusercontent.com/u/63300491?v=4" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">22</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">3</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">4</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 目录</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/img/tools/nmap.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Ulysses'Blog</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 目录</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">端口扫描</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-10-05T11:00:24.000Z" title="发表于 2021-10-05 19:00:24">2021-10-05</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2021-10-06T07:45:58.556Z" title="更新于 2021-10-06 15:45:58">2021-10-06</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Web%E5%AE%89%E5%85%A8/">Web安全</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Web%E5%AE%89%E5%85%A8/%E6%89%AB%E6%8F%8F%E4%B8%8E%E6%9E%9A%E4%B8%BE/">扫描与枚举</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="端口扫描"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h2 id="网络端口"><a href="#网络端口" class="headerlink" title="网络端口"></a>网络端口</h2><h3 id="何为端口"><a href="#何为端口" class="headerlink" title="何为端口"></a>何为端口</h3><p>在网络技术中，端口(Port)大致有两种意思：一是物理意义上的端口，比如，ADSL Modem、集线器、交换机、路由器用于连接其他网络设备的接口，如RJ-45端口、SC端口等等；二是逻辑意义上的端口，一般是指TCP/IP协议中的端口，端口号的范围从0到65535，比如用于浏览网页服务的80端口，用于FTP服务的21端口等等。</p>
<h3 id="端口分类"><a href="#端口分类" class="headerlink" title="端口分类"></a>端口分类</h3><p>按端口号可分为3大类：</p>
<ul>
<li>公认端口（Well Known Ports）：从0到1023，它们紧密绑定（binding）于一些服务。通常这些端口的通讯明确表明了某种服务的协议。例如：80端口实际上总是HTTP通讯。</li>
<li>注册端口（Registered Ports）：从1024到49151。它们松散地绑定于一些服务。也就是说有许多服务绑定于这些端口，这些端口同样用于许多其它目的。例如：许多系统处理动态端口从1024左右开始。</li>
<li>动态和/或私有端口（Dynamic and/or Private Ports）：从49152到65535。理论上，不应为服务分配这些端口。实际上，机器通常从1024起分配动态端口。但也有例外：SUN的RPC端口从32768开始。</li>
</ul>
<h3 id="常用端口"><a href="#常用端口" class="headerlink" title="常用端口"></a>常用端口</h3><p>21端口：FTP 文件传输服务</p>
<p>22端口：SSH 远程连接服务</p>
<p>23端口：TELNET 终端仿真服务</p>
<p>3389端口：Windows远程登录服务</p>
<p>5938端口：TeamViewer 远程服务管理工具</p>
<p>139端口：NetBIOS 文件与打印共享</p>
<p>445端口：SMB 文件共享</p>
<p>25端口：SMTP 简单邮件传输协议</p>
<p>53端口：DNS 域名解析协议</p>
<p>161端口：SNMP 简单网络管理协议</p>
<p>80端口：HTTP 超文本传输协议</p>
<p>443端口：HTTPS SSL加密的超文本传输协议</p>
<p>3306端口：MYSQL数据库端口</p>
<p>5432端口：PostgreSQL数据库端口</p>
<p>1433端口：SQLServer数据库端口</p>
<p>1521端口：Oracle数据库默认端口</p>
<p>6379端口：Redis数据库端口</p>
<p>27017端口：mongoDB数据库默认端口</p>
<p>8080端口：WWW代理服务端口（Tomcat、JBoss等）</p>
<p>9200端口：Elasticsearch服务器端口</p>
<blockquote>
<p>端口大全：<a target="_blank" rel="noopener" href="https://www.douban.com/note/568630865/">https://www.douban.com/note/568630865/</a></p>
</blockquote>
<h2 id="Nmap"><a href="#Nmap" class="headerlink" title="Nmap"></a>Nmap</h2><h3 id="Nmap的介绍"><a href="#Nmap的介绍" class="headerlink" title="Nmap的介绍"></a>Nmap的介绍</h3><p>Nmap (“Network Mapper(网络映射器)”) 是一款开放源代码的网络探测和安全审核的工具。它的设计目标是快速地扫描大型网络，当然用它扫描单个主机也没有问题。Nmap以新颖的方式使用原始IP报文来发现网络上有哪些主机，那些主机提供什么服务(应用程序名和版本)，那些服务运行在什么操作系统(包括版本信息)， 它们使用什么类型的报文过滤器/防火墙，以及一堆其它功能。虽然Nmap通常用于安全审核，许多系统管理员和网络管理员也用它来做一些日常的工作，比如查看整个网络的信息， 管理服务升级计划，以及监视主机和服务的运行。</p>
<blockquote>
<p>nmap中文手册：<a target="_blank" rel="noopener" href="http://www.nmap.com.cn/doc/manual.shtm">http://www.nmap.com.cn/doc/manual.shtm</a></p>
</blockquote>
<h3 id="Nmap的作用"><a href="#Nmap的作用" class="headerlink" title="Nmap的作用"></a>Nmap的作用</h3><ul>
<li>检测活动在网络上的主机（主机发现）</li>
<li>检测主机上的开放端口（端口发现或枚举）</li>
<li>检测到相应的端口（服务发现）的软件或版本</li>
<li>检测操作系统，硬件地址，以及软件版本</li>
<li>检测脆弱性的漏洞（Nmap的脚本）</li>
</ul>
<h3 id="Nmap扫描类型"><a href="#Nmap扫描类型" class="headerlink" title="Nmap扫描类型"></a>Nmap扫描类型</h3><p><img src="/img/gif/loading4.gif" data-original="https://i.loli.net/2021/10/05/A8CljTvOgLra7bD.png" alt="4ea886c07221756bb40621a525063c45.png"></p>
<h4 id="Connect-扫描"><a href="#Connect-扫描" class="headerlink" title="Connect()扫描"></a>Connect()扫描</h4><p>此扫描试图与每一个TCP端口进行“三次握手”通信。如果能够成功建立接连，则证明端口开发，否则为关闭。准确度很高，但是最容易被防火墙和IDS检测到，并且在目标主机的日志中会记录大量的连接请求以及错误信息。</p>
<p>TCP connect端口扫描服务端与客户端建立连接成功（目标端口开放）的过程：</p>
<p>① Client端发送SYN；</p>
<p>② Server端返回SYN/ACK，表明端口开放；</p>
<p>③ Client端返回ACK，表明连接已建立；</p>
<p>④ Client端主动断开连接。</p>
<p>建立连接成功（目标端口开放）</p>
<p><img src="/img/gif/loading4.gif" data-original="https://i.loli.net/2021/10/05/gFEvBsa6hcmVOou.png" alt="46a499298383fb5fd45371d3f75f7a72.png"></p>
<p><strong>TCP connect端口扫描服务端与客户端未建立连接成功（目标端口关闭）过程：</strong></p>
<p>① Client端发送SYN；</p>
<p>② Server端返回RST/ACK，表明端口未开放。</p>
<p>未建立连接成功(目标端口关闭)</p>
<p><span style="color: red;">优点</span>：<strong>实现简单</strong>，<strong>对操作者的权限没有严格要求</strong>（有些类型的端口扫描需要操作者具有root权限），系统中的任何用户都有权力使用这个调用，而且如果想要得到从目标端口返回banners信息，也只能采用这一方法。</p>
<p>另一优点是<strong>扫描速度快</strong>。如果对每个目标端口以线性的方式，使用单独的connect()调用，可以通过同时打开多个套接字，从而加速扫描。</p>
<p><span style="color: red;">缺点</span>：是<strong>会在目标主机的日志记录中留下痕迹</strong>，易被发现，<strong>并且数据包会被过滤掉</strong>。目标主机的logs文件会显示一连串的连接和连接出错的服务信息，并且能很快地使它关闭。</p>
<h4 id="SYN扫描"><a href="#SYN扫描" class="headerlink" title="SYN扫描"></a>SYN扫描</h4><p>扫描器向目标主机的一个端口发送请求连接的SYN包，扫描器在收到SYN/ACK后，不是发送的ACK应答而是发送RST包请求断开连接。这样，三次握手就没有完成，无法建立正常的TCP连接，因此，这次扫描就不会被记录到系统日志中。这种扫描技术一般不会在目标主机上留下扫描痕迹。但是，这种扫描需要有root权限。</p>
<p><img src="/img/gif/loading4.gif" data-original="https://i.loli.net/2021/10/05/To91YVd5qQmH8DW.png" alt="8845cb20fb8c5c43b09d3d9c3ee0f07f.png"></p>
<p><strong>端口开放</strong>：1、Client发送SYN 2、Server端发送SYN/ACK 3、Client发送RST断开（只需要前两步就可以判断端口开放）</p>
<p><strong>端口关闭</strong>：1、Client发送SYN 2、Server端回复RST（表示端口关闭）</p>
<p><span style="color: red;">优点</span>：SYN扫描要比TCP Connect()扫描隐蔽一些，SYN仅仅需要发送初始的SYN数据包给目标主机，如果端口开放，则相应SYN-ACK数据包；如果关闭，则响应RST数据包</p>
<h4 id="秘密扫描"><a href="#秘密扫描" class="headerlink" title="秘密扫描"></a>秘密扫描</h4><p>秘密扫描是一种不被审计工具所检测的扫描技术。</p>
<p>它通常用于在通过普通的防火墙或路由器的筛选（filtering）时隐藏自己。</p>
<p>秘密扫描能躲避IDS、防火墙、包过滤器和日志审计，从而获取目标端口的开放或关闭的信息。由于没有包含TCP 3次握手协议的任何部分，所以无法被记录下来，比半连接扫描更为隐蔽。</p>
<p>但是这种扫描的缺点是扫描结果的不可靠性会增加，而且扫描主机也需要自己构造IP包。现有的秘密扫描有TCP FIN扫描、TCP ACK扫描、NULL扫描、XMAS扫描和SYN/ACK扫描等。</p>
<h5 id="NULL扫描"><a href="#NULL扫描" class="headerlink" title="NULL扫描"></a>NULL扫描</h5><p><strong>反向扫描</strong>—-原理是将一个没有设置任何标志位的数据包发送给TCP端口，在正常的通信中至少要设置一个标志位，根据FRC 793的要求，在端口关闭的情况下，若收到一个没有设置标志位的数据字段，那么主机应该舍弃这个分段，并发送一个RST数据包，否则不会响应发起扫描的客户端计算机。也就是说，如果TCP端口处于关闭则响应一个RST数据包，若处于开放则无相应。但是应该知道理由NULL扫描要求所有的主机都符合RFC 793规定，但是windows系统主机不遵从RFC 793标准，且只要收到没有设置任何标志位的数据包时，不管端口是处于开放还是关闭都响应一个RST数据包。但是基于Unix(如Linux)遵从RFC 793标准，所以可以用NULL扫描。 <strong>经过上面的分析，我们知道NULL可以辨别某台主机运行的操作系统是什么操作系统</strong>。</p>
<p><span style="color: red;">端口开放：Client发送Null，Server没有响应</span></p>
<p><img src="/img/gif/loading4.gif" data-original="https://i.loli.net/2021/10/05/XhoJRmFParscVO8.png" alt="c8492b7911ad031cda1c2397f2591e3d.png"></p>
<p><span style="color: red;">端口关闭：1、Client发送NUll 2、Server回复RST</span></p>
<p><img src="/img/gif/loading4.gif" data-original="https://i.loli.net/2021/10/05/JxNnrIhd1yYF42k.png" alt="ae2b1f1bbc0be98270853833d4dd318a.png"></p>
<p>说明：Null扫描和前面的TCP Connect（）和SYN的判断条件正好相反。在前两种扫描中，有响应数据包的表示端口开放，<strong>但在NUll扫描中，收到响应数据包表示端口关闭</strong>。反向扫描比前两种隐蔽性高些，但精确度也相对低一些。</p>
<h5 id="FIN扫描"><a href="#FIN扫描" class="headerlink" title="FIN扫描"></a>FIN扫描</h5><p>与NULL有点类似，只是FIN为指示TCP会话结束，在FIN扫描中一个设置了FIN位的数据包被发送后，若响应RST数据包，则表示端口关闭，没有响应则表示开放。此类扫描同样不能准确判断windows系统上端口开发情况。</p>
<p><span style="color: red;">端口开放：发送FIN，没有响应</span></p>
<p><span style="color: red;">端口关闭：1、发送FIN 2、回复RST</span></p>
<h5 id="ACK扫描"><a href="#ACK扫描" class="headerlink" title="ACK扫描"></a>ACK扫描</h5><p>扫描主机向目标主机发送ACK数据包。根据返回的RST数据包有两种方法可以得到端口的信息。方法一是： <strong>若返回的RST数据包的TTL值小于或等于64，则端口开放，反之端口关闭</strong>，如图所示。</p>
<p><img src="/img/gif/loading4.gif" data-original="https://i.loli.net/2021/10/05/W4IxheAd3rb9QmK.png" alt="ae854a9215ed0aecad110d320c7af9f8.png"></p>
<h5 id="Xmas-Tree扫描"><a href="#Xmas-Tree扫描" class="headerlink" title="Xmas-Tree扫描"></a>Xmas-Tree扫描</h5><p>通过发送带有下列标志位的tcp数据包</p>
<p>URG：指示数据时紧急数据，应立即处理。</p>
<p>PSH：强制将数据压入缓冲区。</p>
<p>FIN：在结束TCP会话时使用。</p>
<p>正常情况下，三个标志位不能被同时设置，但在此种扫描中可以用来判断哪些端口关闭还是开放，与上面的反向扫描情况相同，依然不能判断windows平台上的端口。</p>
<p><span style="color: red;">端口开放：发送URG/PSH/FIN, 没有响应</span></p>
<p><img src="/img/gif/loading4.gif" data-original="https://i.loli.net/2021/10/05/FtHk1bY2pyfhqij.png" alt="07b4dd67c6489f9380ee350fb16fdc24.png"></p>
<p><span style="color: red;">端口关闭：1、发送URG/PSH/FIN,没有响应 2、响应RST</span></p>
<p><img src="/img/gif/loading4.gif" data-original="https://i.loli.net/2021/10/05/CZyuMh8E4cWk2sp.png" alt="e49245d04f2b5014427760380b287d33.png"></p>
<p>XMAS扫描原理和NULL扫描的类似，<strong>将TCP数据包中的ACK、FIN、RST、SYN、URG、PSH标志位置1后发送给目标主机。在目标端口开放的情况下，目标主机将不返回任何信息</strong>。</p>
<h4 id="Dump扫描"><a href="#Dump扫描" class="headerlink" title="Dump扫描"></a>Dump扫描</h4><p>也被称为Idle扫描或反向扫描，在扫描主机时应用了第三方僵尸计算机扫描。由僵尸主机向目标主机发送SYN包。目标主机端口开发时回应SYN|ACK，关闭时返回RST，僵尸主机对SYN|ACK回应RST，对RST不做回应。从僵尸主机上进行扫描时，进行的是一个从本地计算机到僵尸主机的、连续的ping操作。查看僵尸主机返回的Echo响应的ID字段，能确定目标主机上哪些端口是开放的还是关闭的。</p>
<p><img src="/img/gif/loading4.gif" data-original="https://i.loli.net/2021/10/05/qlFyQgdEDtxIopL.png" alt="3641925bcf36c8b38ef9313c686aceb6.png"></p>
<h3 id="常用命令选项"><a href="#常用命令选项" class="headerlink" title="常用命令选项"></a>常用命令选项</h3><p><strong>执行命令</strong>：<code>nmap [扫描类型] [扫描选项]</code></p>
<ul>
<li>扫描类型</li>
</ul>
<table>
<thead>
<tr>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>-sT</td>
<td>TCP connect()扫描：最基本的扫描方式</td>
</tr>
<tr>
<td>-sS</td>
<td>TCP 同步扫描（TCP SYN）</td>
</tr>
<tr>
<td>-sA</td>
<td>ACK 扫描</td>
</tr>
<tr>
<td>-sN; -sF; -sX</td>
<td>TCP Null，FIN，Xmas-Tree扫描</td>
</tr>
<tr>
<td>-sI &lt;zombie host[:probeport]&gt;</td>
<td>Idle扫描</td>
</tr>
<tr>
<td>-sO</td>
<td>对远程主机所支持的IP协议进行扫描</td>
</tr>
<tr>
<td>-sU</td>
<td>使用UDP扫描</td>
</tr>
<tr>
<td>-sP</td>
<td>使用Ping扫描</td>
</tr>
<tr>
<td>-sW</td>
<td>对滑动窗口的扫描</td>
</tr>
<tr>
<td>-sM</td>
<td>TCP Maimon扫描</td>
</tr>
<tr>
<td>-b  &lt;ftp relay host&gt;</td>
<td>FTP弹跳扫描（FTP bounce scan)</td>
</tr>
<tr>
<td>–scanflags</td>
<td>定制的TCP扫描<br>例如，–scanflags URGACKPSHRSTSYNFIN设置了所有标志位</td>
</tr>
</tbody></table>
<ul>
<li>扫描选项</li>
</ul>
<table>
<thead>
<tr>
<th>通用选项</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>-P0</td>
<td>在扫描之前，不必ping主机</td>
</tr>
<tr>
<td>-PT</td>
<td>在扫描之前使用TCP ping确定哪些主机正在运行</td>
</tr>
<tr>
<td>-PS</td>
<td>对于root用户，这个选项使用SYN包而不是ACK包来对目标主机进行扫描</td>
</tr>
<tr>
<td>-PI</td>
<td>设置这个选项，让nmap使用真正的ping（ICMP echo请求）来扫描目标主机是否正在运行</td>
</tr>
<tr>
<td>-PB</td>
<td>这是默认的ping扫描选项。它使用ACK（-PT）和ICMP（-PI）两种扫描选项并行扫描</td>
</tr>
<tr>
<td>-O</td>
<td>扫描主机的操作系统</td>
</tr>
<tr>
<td>-sV</td>
<td>打开版本探测</td>
</tr>
<tr>
<td>–allports</td>
<td>不为版本探测排除任何端口</td>
</tr>
<tr>
<td>-A</td>
<td>全面扫描</td>
</tr>
<tr>
<td>-v</td>
<td>显示扫描过程</td>
</tr>
<tr>
<td>-p &lt;IP范围&gt;</td>
<td>只扫描指定的端口</td>
</tr>
<tr>
<td>-F</td>
<td>快速 (有限的端口) 扫描</td>
</tr>
<tr>
<td>-r</td>
<td>不要按随机顺序扫描端口</td>
</tr>
<tr>
<td>-T &lt;0-5&gt;</td>
<td>设置调速模板，级别越高扫描速度越快</td>
</tr>
<tr>
<td>-S &lt;IP_Address&gt;</td>
<td>源地址欺骗</td>
</tr>
<tr>
<td>-e &lt;interface&gt;</td>
<td>使用指定的网络接口发送和接收报文</td>
</tr>
<tr>
<td>-g &lt;portnumber&gt;</td>
<td>源端口欺骗</td>
</tr>
<tr>
<td>–data-length  &lt;number&gt;</td>
<td>发送报文时 附加随机数据</td>
</tr>
<tr>
<td>–randomize-hosts</td>
<td>对目标主机的顺序随机排列</td>
</tr>
<tr>
<td>-oN &lt;filespec&gt;</td>
<td>标准输出</td>
</tr>
<tr>
<td>-oX &lt;filespec&gt;</td>
<td>XML输出</td>
</tr>
<tr>
<td>-iL &lt;inputfilename&gt;</td>
<td>从文件列表中输入</td>
</tr>
<tr>
<td>-iR &lt;hostnum&gt;</td>
<td>随机选择目标</td>
</tr>
</tbody></table>
<h3 id="Nmap扫描状态"><a href="#Nmap扫描状态" class="headerlink" title="Nmap扫描状态"></a>Nmap扫描状态</h3><ul>
<li>open ：应用程序在该端口接收 TCP连接和 UDP报文。</li>
<li>closed ：关闭的端口对于nmap也是可访问的，它接收nmap探测报文并作出响应。但没有应用程序在其上监听。</li>
<li>filtered ：由于包过滤阻止探测报文到达端口，nmap无法确定该端口是否开放。过滤可能来自专业的防火墙设备，路由规则 或者主机上的软件防火墙。</li>
<li>unfiltered ：未被过滤状态意味着端口可访问，但是 nmap无法确定它是开放还是关闭。只有用于映射防火墙规则集的 ACK扫描才会把端口分类到这个状态。</li>
<li>open | filtered ：(开放或者被过滤的)：无法确定端口是开放还是被过滤的，开放的端口不响应就是个例子。没有响应也可能意味着报文过滤器丢弃了探测报文或者它引发的任何反应。UDP，IP协议，FIN，Null 等扫描会引起。</li>
<li>closed | filtered ：(关闭或者被过滤的)：无法确定端口是关闭还是被过滤的。</li>
</ul>
<h3 id="常用扫描方案"><a href="#常用扫描方案" class="headerlink" title="常用扫描方案"></a>常用扫描方案</h3><p>1、对单个主机进行全面扫描</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -A 192.168.1.2 </span><br></pre></td></tr></table></figure>

<p>2、使用SYN扫描整个网段</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -sS 192.168.1.0/24</span><br></pre></td></tr></table></figure>

<p>3、扫描指定主机的指定端口</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -sV -p 0-1024,3389 192.168.1.1-127</span><br></pre></td></tr></table></figure>

<p>4、随机选择100000台主机扫描是否运行Web服务器(80端口)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -v -iR 100000 -p 80</span><br></pre></td></tr></table></figure>

<h3 id="Nmap脚本"><a href="#Nmap脚本" class="headerlink" title="Nmap脚本"></a>Nmap脚本</h3><h4 id="脚本参数"><a href="#脚本参数" class="headerlink" title="脚本参数"></a>脚本参数</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">SCRIPT SCAN:</span><br><span class="line">  -sC: equivalent to --script=default</span><br><span class="line">  --script=&lt;Lua scripts&gt;: &lt;Lua scripts&gt; is a comma separated list of</span><br><span class="line">           directories, script-files or script-categories</span><br><span class="line">  --script-args=&lt;n1=v1,[n2=v2,...]&gt;: provide arguments to scripts</span><br><span class="line">  --script-args-file=filename: provide NSE script args in a file</span><br><span class="line">  --script-trace: Show all data sent and received</span><br><span class="line">  --script-updatedb: Update the script database.</span><br><span class="line">  --script-help=&lt;Lua scripts&gt;: Show help about scripts.</span><br><span class="line">           &lt;Lua scripts&gt; is a comma-separated list of script-files or</span><br><span class="line">           script-categories.</span><br></pre></td></tr></table></figure>

<p>上面这部分是Nmap关于脚本的参数，下面一个一个来介绍：</p>
<p><strong>-sC</strong> 是指的是采用默认配置扫描，与**–script=default**参数等价</p>
<p><strong>–script=脚本名称</strong>，脚本一般都在<strong>Nmap的安装目录下的scripts目录中</strong></p>
<p>那么Linux下可以查看脚本数量：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ls /usr/share/nmap/scripts | wc -l</span><br></pre></td></tr></table></figure>

<p><img src="/img/gif/loading4.gif" data-original="https://i.loli.net/2021/10/05/aHpbjvRhzoMP9S8.png" alt="5dfdbf9ebad804bdae51530e4ea4322d.png"></p>
<p>那么我当前的Nmap是有<strong>602</strong>个很使用的漏洞利用、工具脚本。也可以使用下面一条命令导出</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ls /usr/share/nmap/scripts/ | sed &#x27;s/.nse//&#x27; &gt; scripts.list</span><br></pre></td></tr></table></figure>

<p>那么所有的脚本名称都在<strong>scripts.list</strong>中了，这样做的原因是因为我们传递脚本名称的时候，不能写脚本的文件扩展名(.nse)。</p>
<p><strong>–script-args=key1=value1,key2=value2…</strong> 该参数是用来传递脚本里面的参数的，key1是参数名，该参数对应value1这个值，那么有更多的参数，使用逗号连接，后面例子中会给大家讲解。</p>
<p><strong>–script-args-file=filename</strong>，使用文件来为脚本提供参数。</p>
<p><strong>–script-trace</strong> 如果设置该参数，则所有的脚本收发请求过程。</p>
<p><strong>–script-updatedb</strong> 在Nmap的scripts目录里有一个script.db，该文件中保存了当前Nmap可用的脚本，类似于一个小型数据库，如果我们开启nmap并且调用了此参数，则nmap会自行扫描scripts目录中的扩展脚本，进行数据库更新。</p>
<p><strong>–script-help=脚本名称</strong>，调用该参数后，Nmap会输出该脚本名称对应的脚本使用参数，以及详细介绍信息。</p>
<h4 id="实战"><a href="#实战" class="headerlink" title="实战"></a>实战</h4><p>现在我们用一个很简单的脚本，telnet爆破脚本，我们搜索一下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ls /usr/share/nmap/scripts/ | grep telnet</span><br></pre></td></tr></table></figure>

<p><img src="/img/gif/loading4.gif" data-original="https://i.loli.net/2021/10/05/a2wQV4umLnyc9Ai.png" alt="11dafc3bedd4c87c17c238b5b47b19d2.png"></p>
<p>那么可以看到，返回了两个nse脚本名称，那么第一个就是telnet爆破的脚本了，如果不清楚的话，可以使用上面刚介绍过的**–script-help**参数。</p>
<p><img src="/img/gif/loading4.gif" data-original="https://i.loli.net/2021/10/05/JBvNi3jepwEunqC.png" alt="5e78ad47bd955b4ee396e583bdb25701.png"></p>
<p>可以看到 有一个Nmap的文档地址，正是我们现在想要使用的脚本的详细信息。</p>
<p><img src="/img/gif/loading4.gif" data-original="https://i.loli.net/2021/10/05/6UN7Zns3MxywR18.png" alt="95d8e6026a3e1dd7beebdb76182d60f0.png"></p>
<p>最后那个 target指的是我们的目标地址。userdb是用户名字典，passdb是密码字典，timeout是每次连接之间的等待超时时间。</p>
<p>当然了，我们也可以直接查看脚本源文件：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">-- @usage</span><br><span class="line">--   nmap -p 23 --script telnet-brute --script-args userdb=myusers.lst,passdb=mypwds.lst,telnet-brute.timeout=8s &lt;target&gt;</span><br><span class="line">--</span><br><span class="line">-- @output</span><br><span class="line">-- 23/tcp open  telnet</span><br><span class="line">-- | telnet-brute:</span><br><span class="line">-- |   Accounts</span><br><span class="line">-- |     wkurtz:colonel</span><br><span class="line">-- |   Statistics</span><br><span class="line">-- |_    Performed 15 guesses in 19 seconds, average tps: 0</span><br><span class="line">--</span><br><span class="line">-- @args telnet-brute.timeout   Connection time-out timespec (default: &quot;5s&quot;)</span><br><span class="line">-- @args telnet-brute.autosize  Whether to automatically reduce the thread</span><br><span class="line">--                              count based on the behavior of the target</span><br><span class="line">--                              (default: &quot;true&quot;)</span><br></pre></td></tr></table></figure>

<p>上方这块，可以看到有一个例子，还有常规的扫描结果。那么加粗的这行是笔者故意为之，因为在某些情况下，<strong>管理员可能会更改telnet服务的端口</strong>（这里不只是光指Telnet），那么我们就无法使用这个脚本了。聪明的你一定想到了更改上方的<strong>23</strong>端口吧！但是这还不够灵活～ 我们可以将端口号自制成一个变量，通过我们的脚本参数传递进去。这里不再过多赘述。</p>
<p>下面我们来实战一下，先扫描一下靶机。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -sT -Pn -F 192.168.123.188</span><br></pre></td></tr></table></figure>

<p><img src="/img/gif/loading4.gif" data-original="https://i.loli.net/2021/10/05/BVxNAbZiCsk9MaQ.png" alt="d609cbcc9ba1850803475896f11b8802.png"></p>
<p>发现开启了23号端口（telnet服务）</p>
<p>我把字典放到了 <strong>/usr/share/nmap/nselib/data</strong>，因为这个目录中是专门存放Nmap默认字典的。</p>
<p>扫描命令如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -p 23 -Pn --script=telnet-brute --script-args=userdb=admins.lst,passdb=passwords.lst,telnet-brute.timeout=3s --script-trace 192.168.123.188</span><br></pre></td></tr></table></figure>

<p>在这我用**–script-trace**开启了数据的收发开关，扫描结果如下：</p>
<p><img src="/img/gif/loading4.gif" data-original="https://i.loli.net/2021/10/05/Jz5rloZIT7ymU2P.png" alt="e13b32677cd0c2b986d892cba23166ed.png"></p>
<p>试试使用Telnet登录</p>
<p><img src="/img/gif/loading4.gif" data-original="/:/edcd4ad56ed5407b9a12c0ce81f3bc93" alt="ed3da32313f541b436115f74b7eee8fe.png"></p>
<p>登录成功！</p>
<h4 id="脚本分类"><a href="#脚本分类" class="headerlink" title="脚本分类"></a>脚本分类</h4><p>【vuln】漏洞检测方面：<a target="_blank" rel="noopener" href="https://nmap.org/nsedoc/categories/vuln.html">vuln NSE Category</a></p>
<p>【auth】权限验证方面：<a target="_blank" rel="noopener" href="https://nmap.org/nsedoc/categories/auth.html">auth NSE Category</a></p>
<p>【brute】暴力破解方面：<a target="_blank" rel="noopener" href="https://nmap.org/nsedoc/categories/brute.html">brute NSE Category</a></p>
<p>【discovery】服务信息发现：<a target="_blank" rel="noopener" href="https://nmap.org/nsedoc/categories/discovery.html">discovery NSE Category</a></p>
<p>【dos】DOS攻击方面：<a target="_blank" rel="noopener" href="https://nmap.org/nsedoc/categories/dos.html">dos NSE Category</a></p>
<p>【exploit】漏洞利用方面：<a target="_blank" rel="noopener" href="https://nmap.org/nsedoc/categories/exploit.html">exploit NSE Category</a></p>
<p>【external】外部扩展方面：<a target="_blank" rel="noopener" href="https://nmap.org/nsedoc/categories/external.html">external NSE Category</a> （集成了shodanAPI）</p>
<p>【fuzzer】FUZZ测试方面：<a target="_blank" rel="noopener" href="https://nmap.org/nsedoc/categories/fuzzer.html">fuzzer NSE Category</a></p>
<p>【intrusive】一些针对的服务入侵模块：<a target="_blank" rel="noopener" href="https://nmap.org/nsedoc/categories/intrusive.html">intrusive NSE Category</a></p>
<p>【malware】恶意后门方面：<a target="_blank" rel="noopener" href="https://nmap.org/nsedoc/categories/malware.html">malware NSE Category</a></p>
<p>【version】版本识别：<a target="_blank" rel="noopener" href="https://nmap.org/nsedoc/categories/version.html">version NSE Category</a></p>
<p>以上参数都可以作为**–script<strong>的通配参数，例如：</strong>–script=vuln**</p>
<p>-<strong>-script=all</strong> 调用所有脚本扫描</p>
<h3 id="Nmap流量特征修改"><a href="#Nmap流量特征修改" class="headerlink" title="Nmap流量特征修改"></a>Nmap流量特征修改</h3><p>现在主流的流量分析设备也将其流量加入了特征库，为了防止在探测阶段IP就被封掉，对其的流量特征做一些简单的修改有点用的。</p>
<h4 id="Win值修改"><a href="#Win值修改" class="headerlink" title="Win值修改"></a>Win值修改</h4><p>通过观察可以发现nmap在使用SYN扫描时Windows的窗口值值固定是1024。</p>
<p>（PS ：window 关键字用于检查特定的TCP窗口大小）</p>
<p><img src="/img/gif/loading4.gif" data-original="https://i.loli.net/2021/10/05/HtRwjhkfT21Bc9G.jpg" alt="img"></p>
<p>下面是正常连接3389时，发送的数据包。可以看到win值明显不一样。</p>
<p><img src="/img/gif/loading4.gif" data-original="https://pic2.zhimg.com/80/v2-656045f55b5adf42a0e495ff4ce92375_720w.jpg" alt="img"></p>
<p>修改<strong>tcpip.cc</strong>文件中tcp-&gt;th_win的值，查询TCP中win这个值的信息发现，默认最大为65535。所以应该在此范围内都可以。</p>
<p>但是要考虑已公开的规则，如之前大佬写的bypass emergingthreats这篇，这个就过滤了2048 1024 3072 4096。</p>
<p><img src="/img/gif/loading4.gif" data-original="https://pic2.zhimg.com/80/v2-344d90cda7c57744b3e019efb7a5c819_720w.jpg" alt="img"></p>
<h4 id="关键词修改"><a href="#关键词修改" class="headerlink" title="关键词修改"></a>关键词修改</h4><p>根据规则，一个一个去修改文件即可。</p>
<p>nmap，nm，nm@p，OR sqlspider等等，主要的就是SIP文件和一些常用的脚本文件。</p>
<p>这些个就是从emergingthreats的规则中提取的。</p>
<p><img src="/img/gif/loading4.gif" data-original="https://i.loli.net/2021/10/05/iTr1c9Xm53FfMtz.jpg" alt="img"></p>
<p><img src="/img/gif/loading4.gif" data-original="https://i.loli.net/2021/10/05/tmnU5A21pFgPS4X.jpg" alt="img"></p>
<h4 id="UDP探测时填充值修改"><a href="#UDP探测时填充值修改" class="headerlink" title="UDP探测时填充值修改"></a>UDP探测时填充值修改</h4><p>修改<strong>osscan2.cc</strong></p>
<p>也可通过-O参数修改</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">static u8 patternbyte = 0x43; /* character &#x27;C&#x27; */ 替换为 static u8 patternbyte = 0x46; /* character &#x27;F&#x27; */</span><br></pre></td></tr></table></figure>

<p>重新编译后再去扫描，内容已经换了，长度应该也是可以调整。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">u8 packet[328]; /* 20 IP hdr + 8 UDP hdr + 300 data */</span><br></pre></td></tr></table></figure>

<p>这里还没测试，感兴趣可以自己去定义，看会不会有什么问题。</p>
<p><img src="/img/gif/loading4.gif" data-original="https://i.loli.net/2021/10/05/YBiyZ3a4zIRpVtX.jpg" alt="img"></p>
<h4 id="修改脚本中的值"><a href="#修改脚本中的值" class="headerlink" title="修改脚本中的值"></a>修改脚本中的值</h4><ul>
<li>nselib/http.lua</li>
</ul>
<p>USER<em>AGENT = stdnse.get</em>script_args(‘http.useragent’)</p>
<ul>
<li>nselib/mssql.lua</li>
</ul>
<p>搜索Nmap NSE然后替换</p>
<ul>
<li>nselib/sip.lua</li>
</ul>
<p>搜索Nmap NSE然后替换</p>
<ul>
<li>scripts/http-sql-injection.nse</li>
</ul>
<p>搜索sqlspider然后替换</p>
<ul>
<li>scripts/ssl-heartbleed.nse</li>
</ul>
<p>搜索Nmap ssl-heartbleed替换</p>
<ul>
<li>nselib/rdp.lua</li>
</ul>
<p>local cookie = “mstshash=nmap”</p>
<h3 id="Nmap衍生"><a href="#Nmap衍生" class="headerlink" title="Nmap衍生"></a>Nmap衍生</h3><h4 id="Zenmap"><a href="#Zenmap" class="headerlink" title="Zenmap"></a>Zenmap</h4><p><strong>Zenmap是Nmap的官方GUI(图形界面)版本</strong>。</p>
<p><img src="/img/gif/loading4.gif" data-original="https://i.loli.net/2021/10/05/Ku1R2VbmSD6f9gE.png" alt="img"></p>
<h4 id="DNmap"><a href="#DNmap" class="headerlink" title="DNmap"></a>DNmap</h4><p>dnmap是使用客户端/服务器体系结构的分布式nmap框架。 服务器从文件中读取命令，并将其发送给每个客户端。 客户端执行nmap命令并将结果发送回去。</p>
<p>下载地址：<a target="_blank" rel="noopener" href="https://sourceforge.net/projects/dnmap/">https://sourceforge.net/projects/dnmap/</a></p>
<p>有关DNmap的使用可以参考：<a target="_blank" rel="noopener" href="https://www.bilibili.com/read/cv5791617/">https://www.bilibili.com/read/cv5791617/</a></p>
<p><img src="/img/gif/loading4.gif" data-original="https://i.loli.net/2021/10/05/JQCfYZrFNulcaV5.jpg" alt="dnmap_architecture_2"></p>
<h2 id="MasScan"><a href="#MasScan" class="headerlink" title="MasScan"></a>MasScan</h2><h3 id="MasScan的介绍"><a href="#MasScan的介绍" class="headerlink" title="MasScan的介绍"></a>MasScan的介绍</h3><p>Masscan 作为一个端口扫描工具，具备优秀的性能，能够在短时间内对大量的IP和端口进行是否开放的扫描，使用简单，相比于NMAP等工具来说更容易上手，是网络安全领域的优秀工具。Masscan使用C语言编写，核心部分使用C90编写，包含了大量TCP协议相关，以及操作系统相关的底层代码，代码注释完善，十分详尽，结构清晰，是十分值得学习的C语言网络项目。</p>
<h3 id="常用选项"><a href="#常用选项" class="headerlink" title="常用选项"></a>常用选项</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">-p &lt;ports,–ports &lt;ports&gt;&gt; 		指定端口进行扫描</span><br><span class="line">-–banners 				获取banner信息，支持少量的协议</span><br><span class="line">-–rate &lt;packets-per-second&gt; 		指定发包的速率</span><br><span class="line">-c &lt;filename&gt;, --conf &lt;filename&gt; 	读取配置文件进行扫描</span><br><span class="line">–-echo 				将当前的配置重定向到一个配置文件中，可以将文件与-c选项一起使用。</span><br><span class="line">-e &lt;ifname&gt; , --adapter &lt;ifname&gt; 	指定用来发包的网卡接口名称</span><br><span class="line">–-adapter-ip &lt;ip-address&gt; 		指定发包的IP地址</span><br><span class="line">–-adapter-port &lt;port&gt; 			指定发包的源端口</span><br><span class="line">–-adapter-mac &lt;mac-address&gt; 		指定发包的源MAC地址</span><br><span class="line">–-router-mac &lt;mac address&gt; 		指定网关的MAC地址</span><br><span class="line">–-exclude &lt;ip/range&gt; 			IP地址范围黑名单，防止masscan扫描</span><br><span class="line">–-excludefile &lt;filename&gt; 		指定IP地址范围黑名单文件</span><br><span class="line">–-includefile，-iL &lt;filename&gt; 		读取一个范围列表进行扫描</span><br><span class="line">–-ping 				扫描应该包含ICMP回应请求</span><br><span class="line">–-append-output 			以附加的形式输出到文件</span><br><span class="line">-–iflist 				列出可用的网络接口，然后退出</span><br><span class="line">–-retries 				发送重试的次数，以1秒为间隔</span><br><span class="line">-–nmap 				打印与nmap兼容的相关信息</span><br><span class="line">-–http-user-agent &lt;user-agent&gt; 	设置user-agent字段的值</span><br><span class="line">-–show [open,close] 			告诉要显示的端口状态，默认是显示开放端口</span><br><span class="line">-–noshow [open,close] 			禁用端口状态显示</span><br><span class="line">-–pcap &lt;filename&gt; 			将接收到的数据包以libpcap格式存储</span><br><span class="line">-–regress 				运行回归测试，测试扫描器是否正常运行</span><br><span class="line">-–ttl &lt;num&gt; 				指定传出数据包的TTL值，默认为255</span><br><span class="line">-–wait &lt;seconds&gt; 			指定发送完包之后的等待时间，默认为10秒</span><br><span class="line">-–offline 				没有实际的发包，主要用来测试开销</span><br><span class="line">-sL 					不执行扫描，主要是生成一个随机地址列表</span><br><span class="line">–readscan &lt;binary-files&gt; 		读取从-oB生成的二进制文件，可以转化为XML或者JSON格式</span><br><span class="line">–connection-timeout &lt;secs&gt; 		抓取banners时指定保持TCP连接的最大秒数，默认是30秒</span><br><span class="line">-oX &lt;filename&gt;				输出到filename的XML。</span><br><span class="line">-oG &lt;filename&gt;				输出到filename在的grepable格式。</span><br><span class="line">-oJ &lt;filename&gt;				输出到filename在JSON格式。</span><br></pre></td></tr></table></figure>

<h3 id="常用扫描方案-1"><a href="#常用扫描方案-1" class="headerlink" title="常用扫描方案"></a>常用扫描方案</h3><ul>
<li>简单使用</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">masscan 192.168.123.0/24 -p445</span><br></pre></td></tr></table></figure>

<ul>
<li>单ip多端口</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">masscan 192.168.123.188 -p1-1024,8080,3306</span><br></pre></td></tr></table></figure>

<ul>
<li>多ip单端口</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">masscan 192.168.123.1-192.168.123.100,192.168.123.188 -p80</span><br></pre></td></tr></table></figure>

<ul>
<li>快速扫描</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">masscan 192.168.123.0/24 -p1-1024 --rate 10000</span><br></pre></td></tr></table></figure>

<ul>
<li>把当前命令的配置保存下来，然后在其他masscan命令直接引用</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">masscan 192.168.123.188 -p80,8080 --echo &gt; scan.conf</span><br><span class="line">masscan -c scan.conf --rate 1000</span><br></pre></td></tr></table></figure>

<ul>
<li>将扫描结果导出到XML文件</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">masscan 192.168.123.188 -p0-65535 -oX scan.xml</span><br></pre></td></tr></table></figure></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">Ulysses</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://plumeria.ltd/post/cbdcd826.html">https://plumeria.ltd/post/cbdcd826.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://plumeria.ltd" target="_blank">Ulysses'Blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E6%89%AB%E6%8F%8F%E4%B8%8E%E6%9E%9A%E4%B8%BE/">扫描与枚举</a></div><div class="post_share"><div class="social-share" data-image="/img/tools/nmap.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/post/fcfd17ed.html"><img class="prev-cover" src="/img/gif/loading4.gif" data-original="/img/security.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">防护扫描与服务枚举</div></div></a></div><div class="next-post pull-right"><a href="/post/500fa748.html"><img class="next-cover" src="/img/gif/loading4.gif" data-original="/img/security.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">敏感文件目录探测</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/post/500fa748.html" title="敏感文件目录探测"><img class="cover" src="/img/gif/loading4.gif" data-original="/img/security.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-10-05</div><div class="title">敏感文件目录探测</div></div></a></div><div><a href="/post/6d47f502.html" title="针对Web应用的暴力破解"><img class="cover" src="/img/gif/loading4.gif" data-original="/img/tools/burp.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-10-05</div><div class="title">针对Web应用的暴力破解</div></div></a></div><div><a href="/post/8e7b010c.html" title="模糊测试初探"><img class="cover" src="/img/gif/loading4.gif" data-original="/img/tools/fuzz.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-10-05</div><div class="title">模糊测试初探</div></div></a></div><div><a href="/post/2545d0b1.html" title="漏洞扫描概述"><img class="cover" src="/img/gif/loading4.gif" data-original="/img/security.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-10-05</div><div class="title">漏洞扫描概述</div></div></a></div><div><a href="/post/fcfd17ed.html" title="防护扫描与服务枚举"><img class="cover" src="/img/gif/loading4.gif" data-original="/img/security.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-10-05</div><div class="title">防护扫描与服务枚举</div></div></a></div><div><a href="/post/c6e2d2e0.html" title="Web漏洞扫描器"><img class="cover" src="/img/gif/loading4.gif" data-original="/img/tools/awvs.jpeg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-10-05</div><div class="title">Web漏洞扫描器</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/gif/loading4.gif" data-original="https://avatars.githubusercontent.com/u/63300491?v=4" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Ulysses</div><div class="author-info__description"></div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">22</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">标签</div><div class="length-num">3</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">分类</div><div class="length-num">4</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/UlyssesTakusen"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">记录学习与生活~</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E7%AB%AF%E5%8F%A3"><span class="toc-number">1.</span> <span class="toc-text">网络端口</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%95%E4%B8%BA%E7%AB%AF%E5%8F%A3"><span class="toc-number">1.1.</span> <span class="toc-text">何为端口</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AB%AF%E5%8F%A3%E5%88%86%E7%B1%BB"><span class="toc-number">1.2.</span> <span class="toc-text">端口分类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E7%AB%AF%E5%8F%A3"><span class="toc-number">1.3.</span> <span class="toc-text">常用端口</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Nmap"><span class="toc-number">2.</span> <span class="toc-text">Nmap</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Nmap%E7%9A%84%E4%BB%8B%E7%BB%8D"><span class="toc-number">2.1.</span> <span class="toc-text">Nmap的介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Nmap%E7%9A%84%E4%BD%9C%E7%94%A8"><span class="toc-number">2.2.</span> <span class="toc-text">Nmap的作用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Nmap%E6%89%AB%E6%8F%8F%E7%B1%BB%E5%9E%8B"><span class="toc-number">2.3.</span> <span class="toc-text">Nmap扫描类型</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Connect-%E6%89%AB%E6%8F%8F"><span class="toc-number">2.3.1.</span> <span class="toc-text">Connect()扫描</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#SYN%E6%89%AB%E6%8F%8F"><span class="toc-number">2.3.2.</span> <span class="toc-text">SYN扫描</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%A7%98%E5%AF%86%E6%89%AB%E6%8F%8F"><span class="toc-number">2.3.3.</span> <span class="toc-text">秘密扫描</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#NULL%E6%89%AB%E6%8F%8F"><span class="toc-number">2.3.3.1.</span> <span class="toc-text">NULL扫描</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#FIN%E6%89%AB%E6%8F%8F"><span class="toc-number">2.3.3.2.</span> <span class="toc-text">FIN扫描</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#ACK%E6%89%AB%E6%8F%8F"><span class="toc-number">2.3.3.3.</span> <span class="toc-text">ACK扫描</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Xmas-Tree%E6%89%AB%E6%8F%8F"><span class="toc-number">2.3.3.4.</span> <span class="toc-text">Xmas-Tree扫描</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Dump%E6%89%AB%E6%8F%8F"><span class="toc-number">2.3.4.</span> <span class="toc-text">Dump扫描</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%E9%80%89%E9%A1%B9"><span class="toc-number">2.4.</span> <span class="toc-text">常用命令选项</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Nmap%E6%89%AB%E6%8F%8F%E7%8A%B6%E6%80%81"><span class="toc-number">2.5.</span> <span class="toc-text">Nmap扫描状态</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E6%89%AB%E6%8F%8F%E6%96%B9%E6%A1%88"><span class="toc-number">2.6.</span> <span class="toc-text">常用扫描方案</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Nmap%E8%84%9A%E6%9C%AC"><span class="toc-number">2.7.</span> <span class="toc-text">Nmap脚本</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%84%9A%E6%9C%AC%E5%8F%82%E6%95%B0"><span class="toc-number">2.7.1.</span> <span class="toc-text">脚本参数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E6%88%98"><span class="toc-number">2.7.2.</span> <span class="toc-text">实战</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%84%9A%E6%9C%AC%E5%88%86%E7%B1%BB"><span class="toc-number">2.7.3.</span> <span class="toc-text">脚本分类</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Nmap%E6%B5%81%E9%87%8F%E7%89%B9%E5%BE%81%E4%BF%AE%E6%94%B9"><span class="toc-number">2.8.</span> <span class="toc-text">Nmap流量特征修改</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Win%E5%80%BC%E4%BF%AE%E6%94%B9"><span class="toc-number">2.8.1.</span> <span class="toc-text">Win值修改</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%B3%E9%94%AE%E8%AF%8D%E4%BF%AE%E6%94%B9"><span class="toc-number">2.8.2.</span> <span class="toc-text">关键词修改</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#UDP%E6%8E%A2%E6%B5%8B%E6%97%B6%E5%A1%AB%E5%85%85%E5%80%BC%E4%BF%AE%E6%94%B9"><span class="toc-number">2.8.3.</span> <span class="toc-text">UDP探测时填充值修改</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E8%84%9A%E6%9C%AC%E4%B8%AD%E7%9A%84%E5%80%BC"><span class="toc-number">2.8.4.</span> <span class="toc-text">修改脚本中的值</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Nmap%E8%A1%8D%E7%94%9F"><span class="toc-number">2.9.</span> <span class="toc-text">Nmap衍生</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Zenmap"><span class="toc-number">2.9.1.</span> <span class="toc-text">Zenmap</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#DNmap"><span class="toc-number">2.9.2.</span> <span class="toc-text">DNmap</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MasScan"><span class="toc-number">3.</span> <span class="toc-text">MasScan</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#MasScan%E7%9A%84%E4%BB%8B%E7%BB%8D"><span class="toc-number">3.1.</span> <span class="toc-text">MasScan的介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E9%80%89%E9%A1%B9"><span class="toc-number">3.2.</span> <span class="toc-text">常用选项</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E6%89%AB%E6%8F%8F%E6%96%B9%E6%A1%88-1"><span class="toc-number">3.3.</span> <span class="toc-text">常用扫描方案</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/post/ec74cb90.html" title="Oracle数据库注入攻击方式"><img src="/img/gif/loading4.gif" data-original="/img/cover/oracle.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Oracle数据库注入攻击方式"/></a><div class="content"><a class="title" href="/post/ec74cb90.html" title="Oracle数据库注入攻击方式">Oracle数据库注入攻击方式</a><time datetime="2021-10-05T16:43:39.000Z" title="发表于 2021-10-06 00:43:39">2021-10-06</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/post/6daae3c4.html" title="SQLServer数据库注入攻击方式"><img src="/img/gif/loading4.gif" data-original="/img/cover/mssql.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="SQLServer数据库注入攻击方式"/></a><div class="content"><a class="title" href="/post/6daae3c4.html" title="SQLServer数据库注入攻击方式">SQLServer数据库注入攻击方式</a><time datetime="2021-10-05T16:43:38.000Z" title="发表于 2021-10-06 00:43:38">2021-10-06</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/post/d3a798c0.html" title="Access数据库注入攻击方式"><img src="/img/gif/loading4.gif" data-original="/img/cover/access.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Access数据库注入攻击方式"/></a><div class="content"><a class="title" href="/post/d3a798c0.html" title="Access数据库注入攻击方式">Access数据库注入攻击方式</a><time datetime="2021-10-05T16:43:37.000Z" title="发表于 2021-10-06 00:43:37">2021-10-06</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/post/c2f49bfa.html" title="MySQL数据库注入攻击方式"><img src="/img/gif/loading4.gif" data-original="/img/cover/mysql.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="MySQL数据库注入攻击方式"/></a><div class="content"><a class="title" href="/post/c2f49bfa.html" title="MySQL数据库注入攻击方式">MySQL数据库注入攻击方式</a><time datetime="2021-10-05T16:43:36.000Z" title="发表于 2021-10-06 00:43:36">2021-10-06</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/post/724e6336.html" title="SQL注入分类"><img src="/img/gif/loading4.gif" data-original="/img/cover/sql.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="SQL注入分类"/></a><div class="content"><a class="title" href="/post/724e6336.html" title="SQL注入分类">SQL注入分类</a><time datetime="2021-10-05T16:43:35.000Z" title="发表于 2021-10-06 00:43:35">2021-10-06</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2021 By Ulysses</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="algolia-search"><div class="search-dialog"><div class="search-dialog__title" id="algolia-search-title">Algolia</div><div id="algolia-input-panel"><div id="algolia-search-input"></div></div><hr/><div id="algolia-search-results"><div id="algolia-hits"></div><div id="algolia-pagination"></div><div id="algolia-stats"></div></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/search/algolia.js"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())</script><div class="js-pjax"><script>function loadValine () {
  function initValine () {
    const valine = new Valine(Object.assign({
      el: '#vcomment',
      appId: 'iuIup4lvgEwLDu3U8Qc3GOXd-gzGzoHsz',
      appKey: 'Ls9mJKS2MmvbfsPbPCeb2cnA',
      placeholder: 'Please leave your footprints',
      avatar: 'monsterid',
      meta: 'nick,mail,link'.split(','),
      pageSize: '10',
      lang: 'zh-CN',
      recordIP: false,
      serverURLs: '',
      emojiCDN: '',
      emojiMaps: "",
      enableQQ: false,
      path: window.location.pathname,
      requiredFields: ["nick,mail"],
      visitor: false
    }, null))
  }

  if (typeof Valine === 'function') initValine() 
  else getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js').then(initValine)
}

if ('Valine' === 'Valine' || !true) {
  if (true) btf.loadComment(document.getElementById('vcomment'),loadValine)
  else setTimeout(loadValine, 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script></div><script src="/js/smooth-scrolling.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script>
            window.imageLazyLoadSetting = {
                isSPA: false,
                preloadRatio: 1,
                processImages: null,
            };
        </script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(e.href.match(t)||e.href.match(r))&&(e.href=a.dataset.original)})});</script><script>!function(n){n.imageLazyLoadSetting.processImages=o;var e=n.imageLazyLoadSetting.isSPA,i=n.imageLazyLoadSetting.preloadRatio||1,r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]"));function o(){e&&(r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]")));for(var t,a=0;a<r.length;a++)0<=(t=(t=r[a]).getBoundingClientRect()).bottom&&0<=t.left&&t.top<=(n.innerHeight*i||document.documentElement.clientHeight*i)&&function(){var t,e,n,i,o=r[a];t=o,e=function(){r=r.filter(function(t){return o!==t})},n=new Image,i=t.getAttribute("data-original"),n.onload=function(){t.src=i,e&&e()},t.src!==i&&(n.src=i)}()}o(),n.addEventListener("scroll",function(){var t,e;t=o,e=n,clearTimeout(t.tId),t.tId=setTimeout(function(){t.call(e)},500)})}(this);</script></body></html>